# name: test/sql/mssql/37_xml.test
# description: test for MSSQL XML type
# group: [mssql_37_xml]

require odbc_scanner

statement ok
SET VARIABLE conn = odbc_connect('ODBCSCANNER_DEBUG_CONN_STRING_ENV_VAR=ODBC_CONN_STRING')

query I
SELECT * FROM odbc_query(getvariable('conn'), '
  SELECT ''foo'' AS col1, 42 AS col2
  FROM (VALUES (1)) AS tab1(dummy)
  FOR XML AUTO;
')
----
<tab1 col1="foo" col2="42"/>

query I
SELECT column_type from (
  DESCRIBE SELECT * FROM odbc_query(getvariable('conn'), '
    SELECT ''foo'' AS col1, 42 AS col2
    FROM (VALUES (1)) AS tab1(dummy)
    FOR XML AUTO;
  ')
)
----
VARCHAR

query I
SELECT * FROM odbc_query(getvariable('conn'), '
  SELECT ? AS col1, ? AS col2
  FROM (VALUES (1)) AS tab1(dummy)
  FOR XML AUTO;
', params=row('foo', 42))
----
<tab1 col1="foo" col2="42"/>

statement ok
SELECT odbc_close(getvariable('conn'))
